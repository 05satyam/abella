.SUBDIRS: src


################################################
# Distribution
#

BuildDist() =
    rm -rf dist

    mkdir dist
    cp dist-makefile dist/makefile
    cp README dist/README
    cp CHANGELOG dist/CHANGELOG

    mkdir dist/src
    cp src/*.ml src/*.mll src/*.mly src/*.mli dist/src
    rm dist/src/*test*.ml

    mkdir dist/examples
    cp src/*.mod src/*.thm dist/examples

.PHONY: dist
dist: test theorems
    BuildDist()
    make -C dist
    BuildDist()
    rm -f abella.tar.gz
    mv dist abella
    tar c abella | gzip - > abella.tar.gz
    rm -rf abella
